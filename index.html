<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generar Constancia</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&family=Caveat:wght@400..700&family=Comic+Neue:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Huninn&family=M+PLUS+Rounded+1c&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100..900;1,100..900&family=Tektur:wght@400..900&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <img src="img/Logo-Universidad-Tecnologica-de-Culiacan.png" alt="UTC" class="utcLogo" loading="lazy" decoding="async">
    </header>

    <main>
        <article class="heroPage">
            <h1>¿Que es y como funciona?🤔</h1>
            <p>
                En esta pagina podras crear tu constancia escolar de 
                manera gratuita, solo debes llenar el formulario con 
                tus datos escolares, despues hacer click en el boton 
                "Generar PDF", al hacer click se generara una vista 
                previa del archivo y en la parte inferior encontraras 
                un boton para descargar el archivo.
            </p>
            <h2>NOTA!!!🚨</h2>
            <p>
                * Todos los datos que ingreses deben se ser en MAYUSCULA.<br>
                * Tus datos no seran guardados en ningun lugar, por lo 
                que es seguro este lugar 🤝
            </p>
        </article>

        <form>
            <label><strong>NOMBRE COMPLETO: </strong></label>
            <input type="text" id="NombreAlumno" required>
            <label><strong>MATRICULA: </strong></label>
            <input type="number" id="MatriculaAlumno" required>
            <label><strong>CURP: </strong></label>
            <input type="text" id="CURPAlumno" required>
            <label><strong>CARRERA: </strong></label>
            <select id="CarreraAlumno" required>
                <option value="Agricultura Sustentable y Protegida">Agricultura Sustentable y Protegida</option>
                <option value="Ambiental y Sustentabilidad">Ambiental y Sustentabilidad</option>
                <option value="Energías Renovables y Desarrollo Sostenible">Energías Renovables y Desarrollo Sostenible</option>
                <option value="Redes Inteligentes y Ciberseguridad">Redes Inteligentes y Ciberseguridad</option>
                <option value="Gastronomía">Gastronomía</option>
                <option value="Negocios y Mercadotecnia">Negocios y Mercadotecnia</option>
                <option value="Sistemas Automotrices">Sistemas Automotrices</option>
            </select>
            <label><strong>CUATRIMESTRE: </strong></label>
            <select id="Cuatrimestres" required>
                <option value="primer">primer</option>
                <option value="segundo">segundo</option>
                <option value="tercer">tercer</option>
                <option value="cuarto">cuarto</option>
                <option value="quinto">quinto</option>
                <option value="sexto">sexto</option>
                <option value="septimo">septimo</option>
                <option value="octavo">octavo</option>
                <option value="noveno">noveno</option>
                <option value="decimo">decimo</option>
                <option value="onceavo">onceavo</option>
            </select>
            <!--
            <label><strong>INICIO DEL CUATRIMESTRE: </strong></label>
            <label><strong>FIN DEL CUATRIMESTRE: </strong></label>
            -->
            <button onclick="GenerarPDF(event)">Generar PDF</button>
        </form>

        <div class="containerPDF"></div>
        <button id="downloadBtn">Descargar PDF</button>
    </main>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        function GenerarPDF(e) {
            e.preventDefault();
            alert('Revisa si tus datos son los correctos');
            const NombreAlumno = document.getElementById('NombreAlumno').value.trim();
            const MatriculaAlumno = document.getElementById('MatriculaAlumno').value.trim();
            const CURPAlumno = document.getElementById('CURPAlumno').value.trim();
            const CarreraAlumno = document.getElementById('CarreraAlumno').value;
            const CuatrimestreAlumno = document.getElementById('Cuatrimestres').value;
            const ContainerPDF = document.querySelector('.containerPDF');

            //MAYUSCULAS para los datos
            const NOMBREALUMNO = NombreAlumno.toUpperCase();
            const CURPALUMNO = CURPAlumno.toUpperCase();

            ContainerPDF.innerHTML = "";

            //CREAR ENCABEZADO DEL PDF
            const FirstElement = document.createElement('div');
            FirstElement.className = "ContainerHeader";
            const imgTop = document.createElement('img');
            imgTop.src = "img/UTC.png";
            imgTop.className = "ImgTop";
            const SideImg = document.createElement('img');
            SideImg.src = "img/UTCBAN.png";
            SideImg.className = "ImgBan";
            FirstElement.appendChild(imgTop);
            FirstElement.appendChild(SideImg);
            ContainerPDF.appendChild(FirstElement);
            
            // VARIABLES DE TEXTO EN EL PDF
            // DateOficeDue
            // TextCorrespondencia
            // TextPDF

            //FECHA - OFICIO - ASUNTO del PDF
            const SecondElement = document.createElement('div');
            SecondElement.className = "ContainerDateOficeDue";
            const DateOficeDue = document.createElement('p');
            DateOficeDue.className = "DateOficeDue";
            DateOficeDue.innerHTML= 
            `Culiacán de Rosales, Sinaloa, 10 de Septiembre de 2025
            <br>
            Oficio No. SE/2025/3/E075
            <br>
            Asunto: Constancia de Estudio`;
            SecondElement.appendChild(DateOficeDue);
            ContainerPDF.appendChild(SecondElement);

            //A QUIEN CORRESPONDA
            const Correspondencia = document.createElement('div')
            Correspondencia.className = "Correspondencia";
            const TextCorrespondencia = document.createElement('p');
            TextCorrespondencia.className = "TextCorrespondencia";
            TextCorrespondencia.textContent = "A quien corresponda:";
            Correspondencia.appendChild(TextCorrespondencia);
            ContainerPDF.appendChild(Correspondencia);

            //PRIMER PARRAFO DEL PDF
            const ThirdElement = document.createElement('p');
            ThirdElement.className = "TextPDF";
            ThirdElement.innerHTML = 
            `Por este conducto hago constatar que <strong>${NOMBREALUMNO}</strong> con numero de 
            matricula <strong>${MatriculaAlumno}</strong> y CURP <strong>${CURPALUMNO}</strong>, esta inscrito en el 
            ciclo escolar 2024-2025 y cursa el ${CuatrimestreAlumno} cuatrimestre, que inicio 
            el 01 de Septiembre de 2025 y termina el 19 de Diciembre del año 2025, en la 
            carrera de <strong>${CarreraAlumno}</strong>, en la Universidad Tecnológica de Culiacán, 
            turno matutino, con horario de 7:00 a 14:00 horas, con el modelo de 
            clases presenciales.`;

            //SEGUNDO PARRAFO DEL PDF
            const FourthElement = document.createElement('p');
            FourthElement.className = "TextPDF";
            FourthElement.textContent = 
            `Se extiende la presente, para lo fines legales que al interesado 
            convengan, en la ciudad de Culiacán de Rosales, Sinaloa a diez 
            días del mes de Septiembre del año dos mil veinticinco.`;

            const ContainerTextMiddle = document.createElement('div');
            ContainerTextMiddle.className = "ContainerTextMiddle";
            ContainerTextMiddle.appendChild(ThirdElement);
            ContainerTextMiddle.appendChild(FourthElement);
            ContainerPDF.appendChild(ContainerTextMiddle);

            //CREAR FIRMA DEL PDF
            const FifthElement = document.createElement('div');
            FifthElement.className = "ContainerFirma";
            const ImgMid = document.createElement('img');
            ImgMid.src = "img/FIRMA.png";
            ImgMid.className = "ImgMid";
            FifthElement.appendChild(ImgMid);
            ContainerPDF.appendChild(FifthElement);

            //CREAR EL PIE DE PAGINA DEL PDF
            const SixthElement = document.createElement('div');
            SixthElement.className = "FooterPDF";
            const ImgBot1 = document.createElement('img');
            ImgBot1.src = "img/SEP.png";
            ImgBot1.className = "ImgBot1";
            const ImgBot2 = document.createElement('img');
            ImgBot2.src = "img/SINALOA.png";
            ImgBot2.className = "ImgBot2";
            const ImgBot3 = document.createElement('img');
            ImgBot3.src = "img/UTyP.png";
            ImgBot3.className = "ImgBot3";
            const ImgBot4 = document.createElement('img');
            ImgBot4.src = "img/BOTTOMINFO.png";
            ImgBot4.className = "ImgBot4";
            SixthElement.appendChild(ImgBot1);
            SixthElement.appendChild(ImgBot2);
            SixthElement.appendChild(ImgBot3);
            SixthElement.appendChild(ImgBot4);
            ContainerPDF.appendChild(SixthElement);

            //CREAR BARRA INFERIOR DECORATIVA
            const BarraDecorativa = document.createElement('div');
            BarraDecorativa.className = "BarraDecorativa";
            ContainerPDF.appendChild(BarraDecorativa);

            //
            document.getElementById("downloadBtn").addEventListener("click", () => {
            const element = document.querySelector(".containerPDF");

            html2canvas(element).then(canvas => {
                const imgData = canvas.toDataURL("image/png");
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF("p", "mm", "a4");

                // Calculamos el tamaño proporcional al A4
                const imgWidth = 210; // ancho A4 en mm
                const pageHeight = 297; 
                const imgHeight = canvas.height * imgWidth / canvas.width;

                pdf.addImage(imgData, "PNG", 0, 0, imgWidth, imgHeight);
                pdf.save("ConstanciaEscolar.pdf");
            });
        });
        }
    </script>
</body>
</html>